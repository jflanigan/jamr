#!/bin/bash


for i in 1 2 3 4 5 6 7 8 9 10; do

INPUT="${TEST_FILE}"
OUTPUT="${MODEL_DIR}/test.decode.allstages.iter$i"
STAGE1_WEIGHTS="${MODEL_DIR}/stage1-weights"
STAGE2_WEIGHTS="${MODEL_DIR}/stage2-weights.iter$i"

${JAMR_HOME}/run AMRParser \
    --stage1-concept-table "${MODEL_DIR}/conceptTable.train" \
    --stage1-weights "${STAGE1_WEIGHTS}" \
    --stage2-weights "${STAGE2_WEIGHTS}" \
    --dependencies "${INPUT}.snt.deps" \
    --ner "${INPUT}.snt.IllinoisNER" \
    --srl "${INPUT}.snt.srl" \
    --tok "${INPUT}.snt.tok" \
    --training-data "${INPUT}.aligned.no_opN" \
    --stage1-eval \
    -v 0 \
    ${PARSER_OPTIONS} \
    < "${INPUT}.snt" \
    > "${OUTPUT}" \
    2> "${OUTPUT}.err" &

done

wait
